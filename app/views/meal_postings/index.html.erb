<!-- Navbar at the top -->

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">HomeCooked</a>
    </div>
    <ul class="nav navbar-nav navbar-right">
      <li><%= link_to new_user_path do %><span class="glyphicon glyphicon-user"></span> Sign Up <% end %></li>
      <li><%= link_to login_path do %><span class="glyphicon glyphicon-log-in"></span> Login <% end %></li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
      <li>

  <%= form_tag user_location_path, :method => :put, :class => "navbar-form" do %>
    <div class="form-group">
    <%= text_field_tag :address, nil, placeholder: "Location", class: "form-control" %>
    </div>
    <%= submit_tag 'Go', class: "btn btn-default btn-location" %>
  <% end %>

      </li>
    </ul>
  </div>
</nav>

<!-- Google Maps; on right hand side -->

<aside class="google-maps">
  <% if current_user_location %>
    <% theAddress = current_user_location %>
  <% else %>
    <% theAddress = "46 Spadina Avenue Toronto" %>
  <% end %>
    <div id="googleMap" data-user-location='<%=theAddress%>'></div>

  <script type="text/javascript">

    if(window.google){
      initialize()
    } else {
      $.ajax("https://maps.googleapis.com/maps/api/js?key=AIzaSyBHyW__uRnMTsXjGPv54cP5Tli4MhL_vOA&callback=initialize", {
          crossDomain: true,
          dataType: 'script'
      })
    }
  </script>
</aside>

<!-- Meals posted on left hand side -->
<section class="postings">

<!-- First, the categories area and button -->
<div class="categories-area">
  <div class="categories-btn">
    <div class="row row-heading">
      <div class="col-xs-4">
        <div class="container">
          <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Categories
            <span class="caret"></span></button>
            <ul class="dropdown-menu">
              <% @categories.each do |category| %>
                <li>
                  <%= link_to meals_category_path(id: category.id), method: :put do %>
                    <%= category.name %>
                  <% end %>
                </li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-xs-8">
      </div>
    </div>
  </div>
</div>

<!-- Then, all the meals -->
<div class="postings-list">

<% @meal_postings.each do |meal_posting| %>

  <!-- Image -->
  <div class="meal-div" data-address='<%=meal_posting.user.address%>'>
    <div class="media">
      <div class="media-left media-middle">
        <%= cl_image_tag(meal_posting.media[0].url, class: 'media-object') %>
      </div>

      <div class="media-body">
        <div class="container-fluid media-container">

          <!-- Title, meal time(s), cost -->
          <div class="row row-heading">
            <div class="col-xs-4">
              <%= meal_posting.title %>
            </div>

            <div class="col-xs-4">

            </div>

            <div class="col-xs-4">
              Cost: $<%= meal_posting.cost %>
            </div>
          </div>

          <!-- Description -->
          <div class="row row-body">
            <div class="col-xs-12">
            </div>
          </div>

          <!-- Servings left, allergy notices -->
          <div class="row row-footer">
            <div class="col-xs-8">
              <% if meal_posting.end_time %>
                Serving from: <%= meal_posting.base_time %> - <%= meal_posting.end_time%>
              <% else %>
                Serving at: <%= meal_posting.base_time%>
              <% end %>
            </div>
            <div class="col-xs-4">
              Servings Left: <%= meal_posting.servings %>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
<% end %>

</div>

</section>



<!-- this code should be deleted but I need to test that  -->
<!-- AIzaSyBHyW__uRnMTsXjGPv54cP5Tli4MhL_vOA  -->

<!--  <h3>My Google Maps Demo</h3>

 <div id="map" style="width: 320px; height: 380px;"></div>
  <div>
    the address here will be set if the user is signed in and we have their location

      <input id="address" type="textbox" value="46 Spadina Avenue Toronto Ontario" >

    <input type="button" value="your location" onclick="moveYourLocation()">


  </div>
 -->

